(function(){"use strict";var t={4766:function(t,e,o){var r=o(9242),n=o(3396);const d=(0,n._)("div",{id:"teleport-target"},null,-1);function a(t,e){const o=(0,n.up)("router-view");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(o),d],64)}var c=o(89);const u={},i=(0,c.Z)(u,[["render",a]]);var s=i,l=o(2483),p=o(7139);const m=(0,n._)("h2",{class:"page-title"},"Product Kanban Stystem",-1),_={class:"products-board"},f=["onDrop"],g={class:"column-title"},v={class:"sorting"},w=["onClick"],b=["onClick"];function P(t,e,o,d,a,c){const u=(0,n.up)("ProductCard"),i=(0,n.up)("ProductEditedCard"),s=(0,n.up)("BaseModal");return(0,n.wg)(),(0,n.iD)(n.HY,null,[m,(0,n._)("button",{class:"btn page-btn",onClick:e[0]||(e[0]=(...t)=>d.createNewProduct&&d.createNewProduct(...t))},"Создать новый продукт"),(0,n._)("div",_,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(d.columnsList,(o=>((0,n.wg)(),(0,n.iD)("div",{key:o.id,onDrop:t=>d.onDrop(t,o.id),class:(0,p.C_)(["droppable products-board__column",o.columnClass]),onDragover:e[3]||(e[3]=(0,r.iM)((()=>{}),["prevent"])),onDragenter:e[4]||(e[4]=(0,r.iM)((()=>{}),["prevent"]))},[(0,n._)("h3",g,(0,p.zw)(o.name),1),(0,n._)("div",v,[(0,n._)("button",{class:"btn btn-with-img sorting__btn sorting__btn_down",onClick:t=>d.toFilter(0,o.id)},null,8,w),(0,n._)("button",{class:"btn btn-with-img sorting__btn sorting__btn_up",onClick:t=>d.toFilter(1,o.id)},null,8,b)]),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.$store.state.productsInfo.filter((t=>t.columnId===o.id)),(t=>((0,n.wg)(),(0,n.j4)(u,{key:t.id,productData:t,editedProduct:d.editedProduct,"onUpdate:editedProduct":e[1]||(e[1]=t=>d.editedProduct=t),isProductNew:d.isProductNew,"onUpdate:isProductNew":e[2]||(e[2]=t=>d.isProductNew=t),onDragstart:e=>d.onDragStart(e,t.id),class:(0,p.C_)(o.cardsClass),draggable:"true"},null,8,["productData","editedProduct","isProductNew","onDragstart","class"])))),128))],42,f)))),128)),(0,n.Wm)(s,{open:d.editedProduct.isOpened,"onUpdate:open":e[5]||(e[5]=t=>d.editedProduct.isOpened=t)},{default:(0,n.w5)((()=>[d.isProductNew?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(i,{key:0,isProductNew:d.isProductNew,productId:d.editedProduct.editedProductId,currentColumnId:d.getCurrentColumn(d.editedProduct.editedProductId)},null,8,["isProductNew","productId","currentColumnId"])),d.isProductNew?((0,n.wg)(),(0,n.j4)(i,{key:1,isProductNew:d.isProductNew,currentColumnId:"'1'"},null,8,["isProductNew"])):(0,n.kq)("",!0)])),_:1},8,["open"])])],64)}const y={class:"p-card"},h=["src"],C={class:"p-card__title"},I={class:"p-card__category"},D={class:"p-card__rating"},k={class:"p-card__score"},N={class:"p-card__votes-amount"},O={class:"p-card__desc"},H={class:"p-card__price"},j={key:0},U={key:2},q={key:3},T={key:4};function x(t,e,o,r,d,a){const c=(0,n.up)("BaseModal");return(0,n.wg)(),(0,n.iD)("div",y,[(0,n._)("button",{class:"btn btn-with-img p-card-btn p-card__edit-btn",onClick:e[0]||(e[0]=(...e)=>t.startEditingProduct&&t.startEditingProduct(...e))}),(0,n._)("button",{class:"btn btn-with-img p-card-btn p-card__delete-btn",onClick:e[1]||(e[1]=(...e)=>t.toDeleteProduct&&t.toDeleteProduct(...e))}),(0,n._)("img",{class:"p-card__img",src:t.productData.image,alt:"Заголовок",draggable:"false"},null,8,h),(0,n._)("h4",C,(0,p.zw)(t.productData.title),1),(0,n._)("div",I,(0,p.zw)(t.productData.category),1),(0,n._)("div",D,[(0,n._)("span",k,"Rating: "+(0,p.zw)(t.productData.rating.rate),1),(0,n._)("span",N,"Votes: "+(0,p.zw)(t.productData.rating.count),1)]),(0,n._)("p",O,(0,p.zw)(t.productData.description),1),(0,n._)("div",H,(0,p.zw)(t.productData.pricePretty),1),(0,n.Wm)(c,{open:t.isButtonCloseClicked,"onUpdate:open":e[3]||(e[3]=e=>t.isButtonCloseClicked=e)},{default:(0,n.w5)((()=>[t.isDeleted?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("p",j,"Вы уверены, что хотите удалить продукт?")),t.isDeleted?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("button",{key:1,class:"modal-btn",onClick:e[2]||(e[2]=(...e)=>t.deleteProduct&&t.deleteProduct(...e))},"Да")),t.deletingIsFailed?((0,n.wg)(),(0,n.iD)("p",U,"Ошибка! Не удалось удалить продукт.")):(0,n.kq)("",!0),t.isDeleting?((0,n.wg)(),(0,n.iD)("p",q,"Идёт удаление продукта...")):(0,n.kq)("",!0),t.isDeleted?((0,n.wg)(),(0,n.iD)("p",T,"Продукт удалён!")):(0,n.kq)("",!0)])),_:1},8,["open"])])}var F=o(4870),E=o(65);const R=t=>((0,n.dD)("data-v-694f54b2"),t=t(),(0,n.Cn)(),t),S=R((()=>(0,n._)("div",{class:"teleport-blackout"},null,-1))),M={ref:"contentElement",class:"teleport-modal__content"};function V(t,e,o,r,d,a){return t.open?((0,n.wg)(),(0,n.j4)(n.lR,{key:0,to:"#teleport-target"},[S,(0,n._)("div",{class:"teleport-modal",onClick:e[1]||(e[1]=(...e)=>t.onOutsideClick&&t.onOutsideClick(...e)),ref:"modal"},[(0,n._)("div",M,[(0,n._)("button",{type:"button",class:"teleport-modal__close",onClick:e[0]||(e[0]=(...e)=>t.doCloseModal&&t.doCloseModal(...e))},"X"),(0,n.WI)(t.$slots,"default",{},void 0,!0)],512)],512)])):(0,n.kq)("",!0)}const B=(0,F.iH)(new Set);function z(){const{uid:t}=(0,n.FN)(),e=(0,F.iH)(!1),o=()=>{e.value=!0,B.value.add(t)},r=()=>{e.value=!1,B.value.delete(t)},d=(0,n.Fl)((()=>!!B.value.size)),a=()=>{d.value?(document.body.style.paddingRight=window.innerWidth-document.documentElement.clientWidth+"px",document.body.style.overflow="hidden"):(document.body.style.overflow=null,document.body.style.paddingRight=null)};return(0,n.YP)(d,(()=>{a()})),{doOpen:o,doClose:r,isOpen:e,isSomeOpen:d}}var L=(0,n.aZ)({props:{open:{type:Boolean}},setup(t,{emit:e}){const o=(0,F.iH)(null),{doOpen:r,doClose:d}=z(),a=()=>{e("update:open",!1)},c=t=>{t.target!==o.value&&t.target.contains(o.value)&&a()};return(0,n.YP)((()=>t.open),(t=>{t?r():d()}),{immediate:!0}),{onOutsideClick:c,doCloseModal:a,contentElement:o}}});const Z=(0,c.Z)(L,[["render",V],["__scopeId","data-v-694f54b2"]]);var $=Z;const W="https://fakestoreapi.com";var Y=(0,n.aZ)({props:{productData:{type:Object,required:!0}},components:{BaseModal:$},setup(t,{emit:e}){const o=(0,E.oR)(),r=()=>{e("update:isProductNew",!1),e("update:editedProduct",{isOpened:!0,editedProductId:t.productData.id})},n=(0,F.iH)(!1),d=(0,F.iH)(!1),a=(0,F.iH)(!1),c=(0,F.iH)(!1),u=()=>{n.value=!0},i=()=>{d.value=!0,a.value=!1,fetch(`${W}/products/${t.productData.id}`,{method:"DELETE"}).catch((()=>{c.value=!0})).then((t=>t.json())).then((t=>{d.value=!1,a.value=!0,o.dispatch("deleteProduct",t.id)}))};return{isDeleting:d,isDeleted:a,deletingIsFailed:c,isButtonCloseClicked:n,startEditingProduct:r,toDeleteProduct:u,deleteProduct:i}}});const A=(0,c.Z)(Y,[["render",x],["__scopeId","data-v-141e00f4"]]);var K=A;const J=t=>((0,n.dD)("data-v-4e43c9b9"),t=t(),(0,n.Cn)(),t),X={class:"p-card-info"},G=J((()=>(0,n._)("h4",null,"Информация о товаре",-1))),Q={class:"product-form__lable"},tt=J((()=>(0,n._)("span",{class:"product-form__input-title"},"Наименование товара:",-1))),et={class:"product-form__lable"},ot=J((()=>(0,n._)("span",{class:"product-form__input-title"},"Категория товара:",-1))),rt={class:"product-form__lable"},nt=J((()=>(0,n._)("span",{class:"product-form__input-title"},"Адрес изображения товара:",-1))),dt={class:"product-form__lable"},at=J((()=>(0,n._)("span",{class:"product-form__input-title"},"Рейтинг товара:",-1))),ct={class:"product-form__lable"},ut=J((()=>(0,n._)("span",{class:"product-form__input-title"},"Количество проголосовавших:",-1))),it={class:"product-form__lable"},st=J((()=>(0,n._)("span",{class:"product-form__input-title"},"Описание товара:",-1))),lt={class:"product-form__lable"},pt=J((()=>(0,n._)("span",{class:"product-form__input-title"},"Цена товара:",-1))),mt={key:0,class:"modal-btn product-form__btn",type:"submit"},_t={key:1,class:"modal-btn product-form__btn",type:"submit"},ft={key:0},gt={key:1},vt={key:2};function wt(t,e,o,d,a,c){return(0,n.wg)(),(0,n.iD)("div",X,[G,(0,n._)("form",{class:"product-form",action:"#",method:"POST",onSubmit:e[7]||(e[7]=(0,r.iM)(((...e)=>t.saveChanges&&t.saveChanges(...e)),["prevent"]))},[(0,n._)("label",Q,[tt,(0,n.wy)((0,n._)("input",{class:"product-form__input",type:"text","onUpdate:modelValue":e[0]||(e[0]=e=>t.currentTitle=e)},null,512),[[r.nr,t.currentTitle]])]),(0,n._)("label",et,[ot,(0,n.wy)((0,n._)("input",{class:"product-form__input",type:"text","onUpdate:modelValue":e[1]||(e[1]=e=>t.currentCategory=e)},null,512),[[r.nr,t.currentCategory]])]),(0,n._)("label",rt,[nt,(0,n.wy)((0,n._)("input",{class:"product-form__input",type:"url",placeholder:"https://example.com",pattern:"https://.*","onUpdate:modelValue":e[2]||(e[2]=e=>t.currentImageURL=e)},null,512),[[r.nr,t.currentImageURL]])]),(0,n._)("label",dt,[at,(0,n.wy)((0,n._)("input",{class:"product-form__input",type:"text","onUpdate:modelValue":e[3]||(e[3]=e=>t.currentRating=e)},null,512),[[r.nr,t.currentRating]])]),(0,n._)("label",ct,[ut,(0,n.wy)((0,n._)("input",{class:"product-form__input",type:"text","onUpdate:modelValue":e[4]||(e[4]=e=>t.currentVotesAmount=e)},null,512),[[r.nr,t.currentVotesAmount]])]),(0,n._)("label",it,[st,(0,n.wy)((0,n._)("textarea",{class:"product-form__textarea",rows:"10","onUpdate:modelValue":e[5]||(e[5]=e=>t.currentDescription=e)},null,512),[[r.nr,t.currentDescription]])]),(0,n._)("label",lt,[pt,(0,n.wy)((0,n._)("input",{class:"product-form__input",type:"text","onUpdate:modelValue":e[6]||(e[6]=e=>t.currentPrice=e)},null,512),[[r.nr,t.currentPrice]])]),t.isProductNew?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("button",mt,"Сохранить изменения")),t.isProductNew?((0,n.wg)(),(0,n.iD)("button",_t,"Создать")):(0,n.kq)("",!0)],32),t.savingChangesIsFailed?((0,n.wg)(),(0,n.iD)("p",ft,"Ошибка! Не удалось сохранить изменения.")):(0,n.kq)("",!0),t.savingChangesIsDone?((0,n.wg)(),(0,n.iD)("p",gt,"Изменения сохранены")):(0,n.kq)("",!0),t.savingChangesIsLoading?((0,n.wg)(),(0,n.iD)("p",vt,"Сохраняем...")):(0,n.kq)("",!0)])}var bt=(0,n.aZ)({props:{isProductNew:{typy:Boolean,required:!0},productId:{type:[Number,String]},currentColumnId:{type:String,required:!0}},setup(t){const e=(0,E.oR)(),o=e.state.productsInfo.find((e=>e.id===t.productId)),r=(0,F.iH)(),n=(0,F.iH)(),d=(0,F.iH)(),a=(0,F.iH)(),c=(0,F.iH)(),u=(0,F.iH)(),i=(0,F.iH)();o&&(r.value=o.title,n.value=o.category,d.value=o.image,a.value=o.rating.rate,c.value=o.rating.count,u.value=o.description,i.value=o.price);const s=(0,F.iH)(!1),l=(0,F.iH)(!1),p=(0,F.iH)(!1);function m(){s.value=!0,l.value=!1,t.isProductNew?fetch(`${W}/products`,{method:"POST",body:JSON.stringify({title:r.value,price:i.value,description:u.value,image:d.value,category:n.value}),headers:{"Content-type":"application/json; charset=UTF-8"}}).catch((()=>{p.value=!0})).then((t=>t.json())).then((t=>{s.value=!1,l.value=!0,e.dispatch("addNewProduct",{...t,rating:{rate:a.value,count:c.value}})})):fetch(`${W}/products/${t.productId}`,{method:"PATCH",body:JSON.stringify({title:r.value,price:i.value,description:u.value,image:d.value,category:n.value}),headers:{"Content-type":"application/json; charset=UTF-8"}}).catch((()=>{p.value=!0})).then((t=>t.json())).then((t=>{s.value=!1,l.value=!0,e.dispatch("updateProductData",{...t,rating:{rate:a.value,count:c.value}})}))}return{currentTitle:r,currentCategory:n,currentImageURL:d,currentRating:a,currentVotesAmount:c,currentDescription:u,currentPrice:i,savingChangesIsLoading:s,savingChangesIsDone:l,savingChangesIsFailed:p,saveChanges:m}}});const Pt=(0,c.Z)(bt,[["render",wt],["__scopeId","data-v-4e43c9b9"]]);var yt=Pt,ht={name:"HomeView",components:{ProductCard:K,BaseModal:$,ProductEditedCard:yt},setup(){const t=(0,E.oR)();t.dispatch("loadProductsInfo");const e=(0,F.iH)(!1),o=(0,F.iH)({isOpened:!1,editedProductId:0}),r=()=>{e.value=!0,o.value={isOpened:!0,editedProductId:0}},n={firstColumn:{id:1,name:"Товары в наличии",columnClass:"products-board__first-column",cardsClass:"card-is-unsorted"},secondColumn:{id:2,name:"Хочу купить",columnClass:"products-board__second-column",cardsClass:"card-is-wished"},thirdColumn:{id:3,name:"Уже куплено",columnClass:"products-board__third-column",cardsClass:"card-is-achived"}},d=e=>{for(const o of t.state.productsInfo)if(o.id===e)return String(o.columnId);return"0"},a=(e,o)=>{t.dispatch("toFilterProducts",{type:e,columnId:o})};function c(t,e){t.dataTransfer.dropEffect="move",t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("itemId",e.toString())}function u(e,o){const r=parseInt(e.dataTransfer.getData("itemId"));t.dispatch("updateProductColumn",{productId:r,newColumnId:o})}return{isProductNew:e,columnsList:n,editedProduct:o,onDragStart:c,onDrop:u,getCurrentColumn:d,createNewProduct:r,toFilter:a}}};const Ct=(0,c.Z)(ht,[["render",P]]);var It=Ct;const Dt=[{path:"/",name:"home",component:It}],kt=(0,l.p7)({history:(0,l.PO)("/products-kanban-system/"),routes:Dt});var Nt=kt;o(7658);function Ot(t){return new Intl.NumberFormat("ru",{style:"currency",currency:"EUR"}).format(t)}var Ht=(0,E.MT)({state:{productsInfo:[]},getters:{},mutations:{undateProductsInfo(t,e){t.productsInfo=e.map((t=>({...t,pricePretty:Ot(t.price),columnId:1})))},updateColumnOfProduct(t,{productId:e,newColumnId:o}){const r=t.productsInfo.find((t=>t.id===e));r&&(r.columnId=o)},updateProductInfo(t,e){t.productsInfo=t.productsInfo.map((t=>t.id===e.id?{...t,title:e.title,price:e.price,pricePretty:Ot(e.price),description:e.description,category:e.category,rating:{rate:e.rating.rate,count:e.rating.count}}:t))},deletingProduct(t,e){const o=t.productsInfo.findIndex((t=>t.id===e));o>-1&&t.productsInfo.splice(o,1)},addingNewProduct(t,e){t.productsInfo.push({...e,pricePretty:Ot(e.price),columnId:1}),console.log(t.productsInfo)},filtering(t,{type:e,columnId:o}){const r=t.productsInfo.filter((t=>t.columnId===o)),n=t.productsInfo.filter((t=>t.columnId!==o));0===parseInt(e)?r.sort(((t,e)=>t.rating.rate-e.rating.rate)):r.sort(((t,e)=>e.rating.rate-t.rating.rate)),t.productsInfo=n.concat(r)}},actions:{loadProductsInfo(t){return fetch(`${W}/products`).then((t=>t.json())).then((e=>{t.commit("undateProductsInfo",e)}))},updateProductColumn(t,{productId:e,newColumnId:o}){return t.commit("updateColumnOfProduct",{productId:e,newColumnId:o})},updateProductData(t,e){return console.log(e),t.commit("updateProductInfo",e)},deleteProduct(t,e){return console.log(e),t.commit("deletingProduct",e)},addNewProduct(t,e){return console.log(e),t.commit("addingNewProduct",e)},toFilterProducts(t,{type:e,columnId:o}){return t.commit("filtering",{type:e,columnId:o})}},modules:{}});(0,r.ri)(s).use(Ht).use(Nt).mount("#app")}},e={};function o(r){var n=e[r];if(void 0!==n)return n.exports;var d=e[r]={exports:{}};return t[r].call(d.exports,d,d.exports,o),d.exports}o.m=t,function(){var t=[];o.O=function(e,r,n,d){if(!r){var a=1/0;for(s=0;s<t.length;s++){r=t[s][0],n=t[s][1],d=t[s][2];for(var c=!0,u=0;u<r.length;u++)(!1&d||a>=d)&&Object.keys(o.O).every((function(t){return o.O[t](r[u])}))?r.splice(u--,1):(c=!1,d<a&&(a=d));if(c){t.splice(s--,1);var i=n();void 0!==i&&(e=i)}}return e}d=d||0;for(var s=t.length;s>0&&t[s-1][2]>d;s--)t[s]=t[s-1];t[s]=[r,n,d]}}(),function(){o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,{a:e}),e}}(),function(){o.d=function(t,e){for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};o.O.j=function(e){return 0===t[e]};var e=function(e,r){var n,d,a=r[0],c=r[1],u=r[2],i=0;if(a.some((function(e){return 0!==t[e]}))){for(n in c)o.o(c,n)&&(o.m[n]=c[n]);if(u)var s=u(o)}for(e&&e(r);i<a.length;i++)d=a[i],o.o(t,d)&&t[d]&&t[d][0](),t[d]=0;return o.O(s)},r=self["webpackChunkproducts_kanban_system"]=self["webpackChunkproducts_kanban_system"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=o.O(void 0,[998],(function(){return o(4766)}));r=o.O(r)})();
//# sourceMappingURL=app.75aaccfe.js.map